name: SmallTown Actions Test
on:
    push:
        branches:
            - master
jobs:
    my_first_job:
        name: Build_Site
        runs-on: ubuntu-latest
        env:
            BUILD_FLAG: ':rocket:'
        steps:
            - name: Checkout
              uses: actions/checkout@v2.4.0
            # æ£€æŸ¥æœ€æ–° git æäº¤çš„ä¿¡æ¯ï¼Œè¾“å‡ºç»“æœï¼Œå¹¶å°†å…¶è®¾ç½®ä¸º outputs.needbuild å±æ€§
            - name: Get commit message
              id: judge_build_ornot
              run: echo "::set-output name=needbuild::$(git log -1 --pretty='%s' | cut -f1 -d ' ')"
            - name: ğŸ›‘ not need build, end!
              continue-on-error: true
              if: steps.judge_buildornot.outputs.needbuild != env.BUILD_FLAG
              run: echo "NOT NEED EXECUTE BUILD AND DEPLOY."
            #è®¾ç½® node ç¯å¢ƒ
            - name: Setup Node ENV
              if: steps.judge_buildornot.outputs.needbuild == env.BUILD_FLAG
              uses: actions/setup-node@v2
              with:
                node-version: '14'
                cache: 'npm'
            - name: Install Depencencies And Build
              if: steps.judge_buildornot.outputs.needbuild == env.BUILD_FLAG
              run: |
                npm install
                npm run build
            - name: ğŸ‘€ dist folder
              if: steps.judge_buildornot.outputs.needbuild == env.BUILD_FLAG
              run: ls dist
            - name: Deploy to GitHub Pages
              uses: JamesIves/github-pages-deploy-action@4.1.7
              if: steps.judge_buildornot.outputs.needbuild == env.BUILD_FLAG
              with:
                branch: gh-pages
                folder: dist